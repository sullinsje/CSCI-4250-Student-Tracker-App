Developer Notes — Student Tracker App

Overview

- Framework: ASP.NET Core MVC (.NET 9)
- ORM: Entity Framework Core with SQLite (connection string in `appsettings.json` -> `Data/Data.db`)
- Authentication: ASP.NET Identity with custom `ApplicationUser` and role-based authorization (Admin/Teacher/Student)

Key Concepts & Files

- Database and Models
  - `Services/ApplicationDbContext.cs` — EF Core DbContext (inherits `IdentityDbContext<ApplicationUser>`). DbSets: `Students`, `AttendanceRecords`.
  - `Models/Entities/Student.cs` — Student entity, links to Identity user via `UserId`.
  - `Models/Entities/AttendanceRecord.cs` — Attendance record (DateOnly Date, lat/long, ClockType boolean).

- Repositories
  - `Services/IStudentRepository.cs` / `Services/DbStudentRepository.cs` — Student CRUD and adding attendance records.
  - `Services/IAttendanceRepository.cs` / `Services/DbAttendanceRepository.cs` — Attendance-specific read/create operations.
  - `Services/IIdentityUserRepository.cs` / `Services/DbIdentityUserRepository.cs` — Identity user helper methods built on top of UserManager/RoleManager.

- Controllers & Views
  - `Controllers/TeacherController.cs` + `Views/Teacher/*` — Teacher dashboard, student list, attendance history.
  - `Controllers/StudentController.cs` + `Views/Student/*` — Student dashboard and attendance history.
  - `Controllers/AdminController.cs` + `Views/Admin/*` — Admin user management.
  - `Controllers/AuthController.cs` — Login/Registration flows.
  - `Controllers/StudentAPIController.cs` & `Controllers/UserAPIController.cs` — API endpoints for programmatic usage.

Where attendance is stored

- Attendance records are persisted in the `AttendanceRecords` table via EF Core. Each record references a `Student` using `StudentId`. The migration that creates this table is recorded under `Migrations/ApplicationDb`.

Developer Hints

- To map an authenticated user to a `Student` entity: use `User.FindFirstValue(ClaimTypes.NameIdentifier)` to get the Identity id, then query `ApplicationDbContext.Students` where `s.UserId == userId`.
- To add new controller actions or services, follow existing patterns: add an interface in `Services` and implement it in a `Db*Repository` class.
- Migrations: use local `dotnet-ef` (project-level tool) and specify the context when necessary: `dotnet ef migrations add AddWhatever --context ApplicationDbContext` then `dotnet ef database update --context ApplicationDbContext`.

Notes on Documentation Changes

- XML documentation was added to public controllers, repository interfaces and implementations, and entity models to aid IDE tooltips and maintainability.
- If you want automated XML documentation file generation, enable it in the project `.csproj`.

If you'd like, I can:
- Run a build to verify no Razor/compilation warnings were introduced.
- Add comments to any remaining files or add an autogenerated XML docs file to the project build.

Longer Developer README

Getting started

- Prerequisites: .NET 9 SDK, PowerShell (on Windows) or a POSIX shell. The project uses EF Core with a local SQLite file.
- Local DB: The app uses `Data/Data.db` by default. Migrations live under `Migrations/ApplicationDb`.

Run locally (PowerShell):

```
dotnet build StudentTrackerApp.csproj
dotnet run --project StudentTrackerApp.csproj
```

Common workflows

- Create a migration: `dotnet ef migrations add <Name> --context ApplicationDbContext`
- Apply migrations: `dotnet ef database update --context ApplicationDbContext`
- Add a Student for an identity user: create a user via `AdminController` or register as a student; registration creates a `Student` row automatically.

Where to add inline view comments

- Views under `Views/Teacher` and `Views/Student` now include short HTML comments near the top explaining purpose, model usage, and any client-side behaviors (e.g., JS fetch in `AttendanceHistory.cshtml`).

Contributing tips

- Keep view models simple and avoid embedding domain logic in Razor pages. Prefer controllers or services for mapping.
- When changing database schema, always inspect the existing DB file (`Data/Data.db`) and `__EFMigrationsHistory` to avoid duplicate-create errors.
- Use repository interfaces in controllers for easier unit testing.

If you want, I can also:
- Enable XML documentation generation in the `.csproj` and add a `/docs` folder to include the built XML file.
- Add a small CONTRIBUTING.md with branch and commit rules for this repo.

